Run with native agent:
java -agentlib:native-image-agent=config-output-dir=./native -server -classpath /usr/local/src/qpid/Qpid4Graal/native/qpid-broker/8.0.6/lib/*:/usr/local/src/qpid/Qpid4Graal/native/qpid-broker/8.0.6/lib/plugins/*:/usr/local/src/qpid/Qpid4Graal/native/qpid-broker/8.0.6/lib/opt/* -DPNAME=QPBRKR -XX:+UseConcMarkSweepGC -XX:+HeapDumpOnOutOfMemoryError -Xmx512m -XX:MaxDirectMemorySize=1536m -DQPID_HOME=/usr/local/src/qpid/Qpid4Graal/native/qpid-broker/8.0.6 -DQPID_WORK=/var/qpidwork org.apache.qpid.server.Main


Working:
native-image --no-fallback --enable-url-protocols=file -H:DefaultLocale=en -H:EnableURLProtocols=http,https -cp jar:/usr/local/src/qpid/Qpid4Graal/native/qpid-broker/8.0.6/lib/* --verbose -J-Xmx16g -J-XX:+HeapDumpOnOutOfMemoryError -J-XX:MaxDirectMemorySize=1536m -J-server -DPNAME=QPBRKR -DQPID_HOME=/usr/local/src/qpid/Qpid4Graal/native/qpid-broker/8.0.6 -DQPID_WORK=/var/qpidwork -jar qpid-broker-8.0.6.jar qpid


Experimental:
native-image --initialize-at-build-time=org.apache.qpid.server.configuration.CommonProperties --no-fallback -H:EnableURLProtocols=http,https -cp jar:/usr/local/src/qpid/Qpid4Graal/native/qpid-broker/8.0.6/lib/* --verbose -J-Xmx16g -jar qpid-broker-8.0.6.jar qpid     (logback not initialized)


Qpid Java command line:
java -server -classpath /usr/local/src/qpid/Qpid4Graal/native/qpid-broker/8.0.6/lib/*:/usr/local/src/qpid/Qpid4Graal/native/qpid-broker/8.0.6/lib/plugins/*:/usr/local/src/qpid/Qpid4Graal/native/qpid-broker/8.0.6/lib/opt/* -DPNAME=QPBRKR -XX:+UseConcMarkSweepGC -XX:+HeapDumpOnOutOfMemoryError -Xmx512m -XX:MaxDirectMemorySize=1536m -DQPID_HOME=/usr/local/src/qpid/Qpid4Graal/native/qpid-broker/8.0.6 -DQPID_WORK=/var/qpidwork org.apache.qpid.server.Main

qpid-server -DPNAME=QPBRKR -DQPID_HOME=/usr/local/src/qpid/Qpid4Graal/native/qpid-broker/8.0.6 -DQPID_WORK=/var/qpidwork


Specifying Configuration Files as Native Image Arguments

A directory containing configuration files that is not part of the class path can be specified to native-image via -H:ConfigurationFileDirectories=/path/to/config-dir/. This directory must directly contain all four files: jni-config.json, reflect-config.json, proxy-config.json and resource-config.json. A directory with the same four configuration files that is on the class path, but not in META-INF/native-image/, can be provided via -H:ConfigurationResourceRoots=path/to/resources/. Both -H:ConfigurationFileDirectories and -H:ConfigurationResourceRoots can also take a comma-separated list of directories.





/usr/local/src/qpid/Qpid4Graal/native/qpid-broker/8.0.6/lib/derbyLocale_cs.jar
Warning: Invalid classpath entry: /usr/local/src/qpid/Qpid4Graal/native/qpid-broker/8.0.6/lib/derbyLocale_de_DE.jar
Warning: Invalid classpath entry: /usr/local/src/qpid/Qpid4Graal/native/qpid-broker/8.0.6/lib/derbyLocale_es.jar
Warning: Invalid classpath entry: /usr/local/src/qpid/Qpid4Graal/native/qpid-broker/8.0.6/lib/derbyLocale_fr.jar
Warning: Invalid classpath entry: /usr/local/src/qpid/Qpid4Graal/native/qpid-broker/8.0.6/lib/derbyLocale_hu.jar
Warning: Invalid classpath entry: /usr/local/src/qpid/Qpid4Graal/native/qpid-broker/8.0.6/lib/derbyLocale_it.jar
Warning: Invalid classpath entry: /usr/local/src/qpid/Qpid4Graal/native/qpid-broker/8.0.6/lib/derbyLocale_ja_JP.jar
Warning: Invalid classpath entry: /usr/local/src/qpid/Qpid4Graal/native/qpid-broker/8.0.6/lib/derbyLocale_ko_KR.jar
Warning: Invalid classpath entry: /usr/local/src/qpid/Qpid4Graal/native/qpid-broker/8.0.6/lib/derbyLocale_pl.jar
Warning: Invalid classpath entry: /usr/local/src/qpid/Qpid4Graal/native/qpid-broker/8.0.6/lib/derbyLocale_pt_BR.jar
Warning: Invalid classpath entry: /usr/local/src/qpid/Qpid4Graal/native/qpid-broker/8.0.6/lib/derbyLocale_ru.jar
Warning: Invalid classpath entry: /usr/local/src/qpid/Qpid4Graal/native/qpid-broker/8.0.6/lib/derbyLocale_zh_CN.jar
Warning: Invalid classpath entry: /usr/local/src/qpid/Qpid4Graal/native/qpid-broker/8.0.6/lib/derbyLocale_zh_TW.jar

